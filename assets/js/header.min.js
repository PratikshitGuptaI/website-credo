const root = document.documentElement;
const pathname = window.location.pathname;

const landingPagePattern = /(\/services\/)(\S+)(-services\.html)/;

if (pathname.match(landingPagePattern)) {
  root.className += ' landing-page';
} else {
  root.className += ' normal-page';
}

const pagesWithTwoForms = [
  '/services/cloud-application-development-services.html',
  '/services/cloud-migration-services.html',
  '/services/application-development-services.html',
];

if (pagesWithTwoForms.indexOf(pathname) >= 0) {
  root.className += ' landing-two-forms';
}

let posts;

const pagesWithBlog = [
  '/',
  '/index.html',
  '/compaign.html',
  '/solutions.html',
  '/api-solutions.html',
  '/industries.html',
  '/resources.html',
  '/company.html',
];

const pagesWithMenuBlog = [
  '/',
  '/index.html',
  '/home.html',
  '/compaign.html',
  '/company.html',
  '/careers.html',
  '/solutions.html',
  '/api-solutions.html',
  '/industries.html',
  '/resources.html',
  '/cloud-advisory-services.html',
  '/application-development-services.html',
  '/cloud-managed-services.html',
  '/devops-services.html',
  '/cloud-migration-services.html',
  '/resources/luxury-retailers-continuous-integration.html',
  '/resources/insurance-brokerage-statutory-compliance.html',
  '/resources/cardiology-practice-custom-application.html',
  '/resources/financial-firm-merchant-on-boarding.html',
  '/resources/tyre-manufacturer-custom-application.html',
  '/resources/enhanced-lms-operations-and-scalability.html',
];

const pagesWithFeaturedCTA = [
  '/',
  '/index.html',
  '/home.html',
  '/compaign.html',
  '/solutions.html',
  '/api-solutions.html',
  '/industries.html',
  '/resources.html',
  '/resources/luxury-retailers-continuous-integration.html',
  '/resources/insurance-brokerage-statutory-compliance.html',
  '/resources/cardiology-practice-custom-application.html',
  '/resources/financial-firm-merchant-on-boarding.html',
  '/resources/tyre-manufacturer-custom-application.html',
  '/resources/enhanced-lms-operations-and-scalability.html',
];

function sticky() {
  const scroll = jQuery(window).scrollTop();

  if (scroll >= 20) {
    $('.header')
      .removeClass('dark-bg')
      .addClass('fixed');
  } else {
    $('.header')
      .removeClass('fixed')
      .addClass('dark-bg');
  }
}

// Window scroll function
$(window).scroll(() => {
  sticky();
});

// Read case study transition
// $('.finance-industry .read-box')
//   .on('mouseover', () => {
//     $('.finance-industry .read-box').addClass('ani');
//   })
//   .on('mouseout', () => {
//     $('.finance-industry .read-box').removeClass('ani');
//   });

// $('.enterprise-industry .read-box')
//   .on('mouseover', () => {
//     $('.enterprise-industry .read-box').addClass('ani');
//   })
//   .on('mouseout', () => {
//     $('.enterprise-industry .read-box').removeClass('ani');
//   });

$(document).ready(() => {
  /* eslint prefer-const: "error" */
  /* eslint-env es6 */
  // const abc = 'https://www.cloudnowtech.com//';
  // const url = abc.replace(/([^:]\/)\/+/g, '$1');
  /* eslint-disable-next-line no-console */
  // console.log(url);
});

$(document).ready(() => {
  sticky(); // if reload the page after scrolling call here
  $('#nav-icon, #navigation li a').click(function() {
    $('.hamburger').toggleClass('animate-icon');
    $('body').toggleClass('ov-hidden');
    $('#overlay').fadeToggle();
  });

  $(window).scroll(function() {
    if ($(window).scrollTop() > 400) {
      $('.go-top').addClass('top-show');
    } else {
      $('.go-top').removeClass('top-show');
    }
  });

  $("a[href='#top']").click(() => {
    $('html, body').animate(
      {
        scrollTop: 0,
      },
      'slow',
    );
    return false;
  });
  // scroll to bottom section
  $("a[href='#reveal']").click(() => {
    $('html,body').animate(
      {
        scrollTop:
          $(
            // eslint-disable-next-line max-len
            '#projectCounts, #section-nav, .our-story, #latestProjects, .scrollBtm, #development-platform, #partner-logos, #services, #apiDesign, #ourServices',
            '#overview',
            '#reveal',
          ).offset().top - 50,
      },
      'slow',
    );
    return false;
  });

  // onload url with id come top of the page
  if (window.location.hash) {
    const hash = window.location.hash;
    $('html, body').animate(
      {
        scrollTop: $(hash).offset().top - 75,
      },
      1000,
    );
    // setTimeout(function() {
    //   $('.header.fixed').attr(
    //     'style',
    //     'visibility: visible; animation-name: fadeInDown; animation-duration: 1s;',
    //   );
    //   $('ul.navigation li a').attr(
    //     'style',
    //     'visibility: visible; animation-duration: 1s; animation-name: slideInLeft;',
    //   );
    // }, 500);
  }

  // anchor with id click function
  $('li > a[href*=\\#]').on('click', function() {
    // e.preventDefault();
    $('html, body').animate(
      {
        scrollTop: $(this.hash).offset().top - 75,
      },

      500,
    );
    // setTimeout(function () {
    //   $('.header.fixed').attr(
    //     'style',
    //     'visibility: visible; animation-name: fadeInDown; animation-duration: 1s;',
    //   );
    //   $('ul.navigation li a').attr(
    //     'style',
    //     'visibility: visible; animation-duration: 1s; animation-name: slideInLeft;',
    //   );
    // }, 500);
  });

  if (pagesWithFeaturedCTA.indexOf(pathname) >= 0) {
    $(window).scroll(function() {
      const scrollDistance = $(window).scrollTop();

      if (
        scrollDistance >= $('#ctaFeatured').position().top - 300 &&
        scrollDistance < $('#ctaFeatured').position().top + 10
      ) {
        $('.cta-highlighted-overlay').removeClass('d-none');
        $('.cta-highlightable').addClass('cta-highlighted');
      } else {
        $('.cta-highlighted-overlay').addClass('d-none');
        $('.cta-highlightable').removeClass('cta-highlighted');
      }
    });
  }
});
// RSS Feeds
// $.ajax({
//   url: 'https://api.rss2json.com/v1/api.json',
//   method: 'GET',
//   dataType: 'json',
//   data: {
//     rss_url: 'https://www.cloudnowtech.com/blog/rss',
//     api_key: '0atjwazt7zqkpxu5kgkmuyi4r1l9trpr1qpfrmiv', // put your api key here
//     count: 3,
//   },
// }).done(response => {
//   // const months = [
//   //   'January',
//   //   'February',
//   //   'March',
//   //   'April',
//   //   'May',
//   //   'June',
//   //   'July',
//   //   'August',
//   //   'September',
//   //   'October',
//   //   'November',
//   //   'December',
//   // ];

//   if (response.status !== 'ok') {
//     throw response.message;
//   }
//   Object.entries(response.items).forEach(key => {
//     const item = key[1];
//     // const div = document.getElementById(`feed_${parseInt(key[0]) + 1}`);
//     // const feedDate = document.getElementById(`feed_date_${parseInt(i) + 1}`);
//     // const date = new Date(item.pubDate);
//     // const curDate = `${months[date.getMonth()]} ${date.getDate()}th,`+`
//     // ${date.getFullYear()}`;
//     const feedTitle = item.title;
//     const feedText = `${item.content.replace(/(<([^>]+)>)/gi, '').substring(1, 80)} ...`;
//     const feedImg = item.thumbnail.replace('?resize=150%2C150&ssl=1', '?resize=550%2C350&ssl=1');
//     const feedLink = item.link;
//     document.getElementById(`feed_${parseInt(key[0]) + 1}_title`).innerHTML = feedTitle;
//     document.getElementById(`feed_${parseInt(key[0]) + 1}_text`).innerHTML = feedText;
//     document.getElementById(
//       `feed_${parseInt(key[0]) + 1}_img`,
//     ).style.backgroundImage = `url(${feedImg})`;
//     // feedDate.append(curDate);
//     document.getElementById(`feed_${parseInt(key[0]) + 1}_link`).href = feedLink;
//   });
// });

switch (pathname) {
  case '/index.html':
    posts = ['1201', '1158', '1426'];
    break;

  case '/compaign.html':
    posts = ['1201', '1158', '1305'];
    break;

  case '/solutions.html':
    posts = ['1305', '1426', '1158'];
    break;

  case '/api-solutions.html':
    posts = ['1121', '1426', '1288'];
    break;

  case '/industries.html':
    posts = ['1391', '1121', '1345'];
    break;

  case '/resources.html':
    posts = ['1445', '1280', '1451'];
    break;

  case '/company.html':
    posts = ['1431', '1421', '1332'];
    break;

  default:
    posts = ['1201', '1158', '1426'];
    break;
}

if (pagesWithBlog.indexOf(pathname) >= 0) {
  Object.entries(posts).forEach(key => {
    const postId = key[1];
    $.ajax({
      url: `https://www.cloudnowtech.com/blog/wp-json/wp/v2/posts/${postId}`,
      method: 'GET',
      dataType: 'json',
      success(data) {
        document.getElementById(`feed_${parseInt(key[0]) + 1}_title`).innerHTML =
          data.title.rendered;
        document.getElementById(
          `feed_${parseInt(key[0]) + 1}_text`,
        ).innerHTML = `${data.content.rendered.replace(/(<([^>]+)>)/gi, '').substring(0, 140)} ...`;
        document
          .getElementById(`feed_${parseInt(key[0]) + 1}_img`)
          .setAttribute('data-background-image', `${data.jetpack_featured_media_url}`);

        document.getElementById(`feed_${parseInt(key[0]) + 1}_link`).href = data.link;
      },
    });
  });
}

// menu blog feeds

if (pagesWithMenuBlog.indexOf(pathname) >= 0) {
  Object.entries(posts).forEach(key => {
    const postId = key[1];
    $.ajax({
      url: `https://www.cloudnowtech.com/blog/wp-json/wp/v2/posts/${postId}`,
      method: 'GET',
      dataType: 'json',
      success(data) {
        document.getElementById(`blog_${parseInt(key[0]) + 1}_title`).innerHTML =
          data.title.rendered;
        document.getElementById(
          `blog_${parseInt(key[0]) + 1}_text`,
        ).innerHTML = `${data.content.rendered.replace(/(<([^>]+)>)/gi, '').substring(0, 140)} ...`;
        document
          .getElementById(`blog_${parseInt(key[0]) + 1}_img`)
          .setAttribute('src', `${data.jetpack_featured_media_url}`);

        document.getElementById(`blog_${parseInt(key[0]) + 1}_link`).href = data.link;
      },
    });
  });
}

$(document).ready(function() {
  $('.scroll-indicator, .slide-down').on('click', function(event) {
    if (this.hash !== '') {
      event.preventDefault();
      const hash = this.hash;
      $('html, body').animate(
        {
          scrollTop: $(hash).offset().top,
        },
        800,
        function() {
          window.location.hash = hash;
        },
      );
    }
  });
});

// Main menu Dropdown //
$(document).ready(function() {
  // when you hover a toggle show its dropdown menu
  $('.header li.dropdown').mouseover(function() {
    // $(this).toggleClass('show');
    $('ul.menu').addClass('noborder');
    $('.header').addClass('hover-fixed');
  });
  $('.header li.dropdown').mouseout(function() {
    // $(this).toggleClass('show');
    $('ul.menu').removeClass('noborder');
    $('.header').removeClass('hover-fixed');
  });
  $('.mobil-dropdown-menu .ddown-arw').click(function() {
    $('.mobile-dropdown').slideToggle();
    $('.ddown-arw i').toggleClass('rottate');
  });

  $('.industries-menu .industries-arw').click(function() {
    $('.industries-dropdown').slideToggle();
    $('.industries-arw i').toggleClass('rottate');
  });

  $('.industry-menu-btn').click(function() {
    setTimeout(function() {
      window.location.reload();
    }, 450);
  });

  $('.industry-menu-btn')
    .click(function() {
      const scrollDistance = $(window).scrollTop();
      const winHeight = $(window).height() - 110;
      const halfHeight = $(window).scrollTop() + winHeight;
      if (scrollDistance >= $('#secondaryNav').position().top) {
        $('.inner__header').addClass('sticky');
      } else {
        $('.inner__header').removeClass('sticky');
        $('.page__header').removeClass('sticky');
      }

      if (scrollDistance <= $('.industry-section').position().top) {
        $('.inner__header').removeClass('sticky');
        $('.page__header').removeClass('sticky');
      } else {
        $('.inner__header').addClass('sticky');
      }

      $('.industry-section').each(function(i) {
        if ($(this).position().top <= halfHeight) {
          $('.page__header li.active').removeClass('active');
          $('.page__header li')
            .eq(i)
            .addClass('active');
        }
      });
    })
    .scroll();
});

// Main Menu Dropdown END //
